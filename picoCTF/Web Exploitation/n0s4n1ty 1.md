# Overview 
Category: [Web Exploitation]()

AUTHOR: Prince Niyonshuti N

# Description
A developer has added profile picture upload functionality to a website. However, the implementation is flawed, and it presents an opportunity for you. Your mission, should you choose to accept it, is to navigate to the provided web page and locate the file upload area. Your ultimate goal is to find the hidden flag located in the /root directory.
Additional details will be available after launching your challenge instance.

# Solution
- Trang web có chức năng upload filefile

![](./image/2025-04-23_16-47.png)

- Sau khi upload lên file .txt thì thành công và biết được web đang dùng php 

- Do web chặn upload file .php  nên ta sẽ bypass bằng cách .png.php (do dev chỉ config xác định loại file bằng cách lấy extension sau dấu "." đầu tiên)
```php
explode('.', $_FILES['file']['name'])[1];
```

![](./image/2025-04-23_16-48.png)

- Kết quả trả về version PHP 

![](./image/2025-04-23_16-48_1.png)

- Thay đổi payload để dễ rce 

![](./image/2025-04-23_16-55.png)

- Xem người dùng hiện tại và xem có quyền sudo không 

![](./image/2025-04-23_16-56.png)

![](./image/2025-04-23_16-57.png)

=> Hiện tại đang là : www-data và có quyền chạy sudo mà không cần pass

- Thực hiện đọc file trong thưc mục /root và lấy flag :

![](./image/2025-04-23_16-57_1.png)
![](./image/2025-04-23_17-01.png)

>Flag : **picoCTF{wh47_c4n_u_d0_wPHP_4043cda3}**