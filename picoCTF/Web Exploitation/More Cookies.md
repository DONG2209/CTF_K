# Overview 
Category: [Web Exploitation]()

AUTHOR: MADSTACKS

# Description
I forgot Cookies can Be modified Client-side, so now I decided to encrypt them! http://mercury.picoctf.net:21553/

# Solution
- Grab the auth_name cookie and store it in a Cookie variable; Base64 decode twice the cookie.
```python
import requests
from base64 import b64decode

Target = "http://mercury.picoctf.net:21553/"

# Create a session object:
session = requests.Session()

# Timeout and retry settings
timeout_seconds = 30  # Increase the timeout to 30 seconds
max_retries = 3  # Number of retry attempts

def fetch_cookie_with_retries(url, session, retries, timeout):
    """Fetch the cookie from the URL with retry logic."""
    for attempt in range(retries):
        try:
            response = session.get(url, timeout=timeout)
            response.raise_for_status()  # Raises an HTTPError for bad responses
            return session.cookies.get("auth_name")
        except requests.exceptions.RequestException as e:
            print(f"Attempt {attempt + 1} failed: {e}")
            if attempt == retries - 1:
                raise  # Reraise the last exception if max retries are exceeded
    return None

try:
    # Fetch the cookie with retries:
    Cookie = fetch_cookie_with_retries(Target, session, max_retries, timeout_seconds)

    if Cookie:
        # Base64 decode twice:
        Raw_Cookie = b64decode(b64decode(Cookie))
        print("Decoded Cookie:", Raw_Cookie)
    else:
        print("auth_name cookie not found!")

except requests.exceptions.RequestException as e:
    print(f"An error occurred: {e}")

```

```
Decoded Cookie: b"\x81w\xae\x8b\xefyY\xd38'~\xa3\x96\xae1\xd1\xbbU<\x859<gq\xd2c\xa5X*\x9b\xa5\xe2E\xfe\xa9!\x9f\x1a\x02\x053M\x18\x19=Zjwd\xfb\\\x84\xe2w\xf8\x84I\xa9\x82K)\xc3\xd4\xc5\x8fR'\xa39\xc8\xffs\x94|\x90\x0c\\\x8b\xf5m\xe9SG\xba,\xed\xe5\xd1\xbe\x8brv\x83\x13}\n"
```

References : [link](https://younestasra-r4z3rsw0rd.github.io/posts/MoreCookies/)