# Overview 
Category: [Web Exploitation]()

AUTHOR: NANDAN DESAI

# Description
BookShelf Pico, my premium online book-reading service.
I believe that my website is super secure. I challenge you to prove me wrong by reading the 'Flag' book!

# Solution
- I login Username: "user" & Password: "user". I receive the token :
<img src="https://i.imgur.com/hxwv13L.png">

- To read the flag, I must log in with the admin account. So I need to adjust the token to become Admin
- View JwtService.java file
<img src="https://i.imgur.com/1IhuJrG.png">

We need to know: Secret_key, Userid, Email, Role 
- The above code refers to Secretginator . I view Secretginator.java :
<img src="https://i.imgur.com/KUIq5gg.png">

In this source code, it appears that it first attempts to read the key from a local file server_secret.txt, but if the file doesn’t exist, then it instead uses a hardcoded “random” string of 1234 instead
-> I know Secret_key: 1234
- Then ,check BookShelfConfig.java file . I know the email of Admin : "admin"
<img src="https://i.imgur.com/pckAdUi.png">

- Inspecting the Role.java source code gives us a hint that the higher the value, the more the privilege:
<img src="https://i.imgur.com/CQm0R2A.png">

So I guess the userid is 2 (if not, I keep increasing)
- Finally to read the flag the role is Admin.
- With all of this information, we can now encode a new JWT token using [jwt.io](https://jwt.io/)
<img src="https://i.imgur.com/Chx3c3G.png">

- Now we just need to copy and paste our newly created JWT token into the auth-token section and also replace token-payload with our new payload details
<img src="https://i.imgur.com/eoy594Y.png">

- Great, we have logged in as Admin
<img src="https://i.imgur.com/v3Frhj2.png">

>Flag: **picoCTF{w34k_jwt_n0t_g00d_d7c2e335}**